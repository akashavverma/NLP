RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (4 random seeds)
Train scheme: fine-tuning
Max sequence length: 512
Min context length: 350
Batch size: 4
Dropout rate: 0.1
Learning rate: 1e-05
Adam Epsilon: 1e-08
Use MLP: False
Weight decay: 0.001
Train time: 01h04m58s
GPU name: NVIDIA GeForce RTX 3090
GPU memory: 23.69

Averages:
Epoch Train loss   std    Test loss   std    P (micro) P std  R (micro) R std  F1 (micro) F1 std P (weighted) P std  R (weighted) R std  F1 (weighted) F1 std
  1    1.006151  0.007536  0.847115 0.064350   0.7247  0.0171   0.7247  0.0171   0.7247   0.0171    0.7172    0.0136    0.7247    0.0171     0.7022    0.0200
  2    0.789911  0.002766  0.798719 0.040033   0.7478  0.0039   0.7478  0.0039   0.7478   0.0039    0.7265    0.0131    0.7478    0.0039     0.7269    0.0122
  3    0.748286  0.002469  0.800777 0.011691   0.7399  0.0074   0.7399  0.0074   0.7399   0.0074    0.7221    0.0137    0.7399    0.0074     0.7159    0.0040
  4    0.689361  0.007267  0.797481 0.017083   0.7414  0.0050   0.7414  0.0050   0.7414   0.0050    0.7253    0.0046    0.7414    0.0050     0.7262    0.0048

*** Detailed report ***

Confusion matrices
------------------
ANALYSIS: 0 
ARG_PETITIONER: 1 
ARG_RESPONDENT: 2 
FAC: 3 
ISSUE: 4 
NONE: 5 
PREAMBLE: 6 
PRE_NOT_RELIED: 7 
PRE_RELIED: 8 
RATIO: 9 
RLC: 10 
RPC: 11 
STA: 12 
=> Iteration 0:
Epoch 1:
[[915   4   0  25   1   0   1   0  37   2   0   0   1]
 [ 56   4   0   6   0   0   0   0   4   0   0   0   0]
 [ 27   9   0   2   0   0   0   0   0   0   0   0   0]
 [ 81   0   0 464   2   6  17   0   1   0   9   0   1]
 [ 11   0   0  17  21   2   0   0   0   0   0   0   0]
 [ 22   0   0   9   1  82  37   0   5   6   0  30   0]
 [  0   0   0   6   0   2 496   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 68   0   0   0   0   0   0   0  74   0   0   0   0]
 [ 59   0   0   0   0   0   0   0   3   7   0   3   0]
 [ 33   0   0  57   0   6   1   0  11   0   8   0   0]
 [ 55   0   0   0   0   0   0   0   2   6   0  29   0]
 [ 21   0   0   0   0   0   0   0   0   0   0   0   8]]
Epoch 2:
[[829  17   4  39   6   1   1   0  23  22   0  25  19]
 [ 34  16   6  11   1   0   0   0   2   0   0   0   0]
 [ 20   9   7   0   2   0   0   0   0   0   0   0   0]
 [ 47   9   0 491   9   3   9   0   0   0   8   0   5]
 [  6   0   0  16  26   2   0   0   0   0   0   0   1]
 [  9   0   0  23   1 111  26   0   1   0   0  21   0]
 [  0   0   0   7   0   9 488   0   5   0   0   0   0]
 [ 11   1   0   0   0   0   0   0   0   0   0   0   0]
 [ 67   0   0   1   0   0   0   0  63   9   0   0   2]
 [ 20   0   0   0   0   2   0   0   0  24   0  26   0]
 [ 32   0   0  71   3   0   0   0   0   0  10   0   0]
 [  4   0   0   0   0  18   0   0   0   3   0  67   0]
 [  7   1   0   1   0   0   0   0   0   0   0   0  20]]
Epoch 3:
[[803   4   9  82  13   1   1   0  22  24   2   5  20]
 [ 38   0  10  17   3   0   0   0   0   0   2   0   0]
 [ 16   1  16   3   2   0   0   0   0   0   0   0   0]
 [ 33   0   2 490  21   6   8   0   0   0  16   0   5]
 [  6   0   0   9  33   2   0   0   0   0   0   0   1]
 [  5   0   0  23   3 109  19   0   4   4   0  25   0]
 [  0   0   0  12   0   9 483   0   5   0   0   0   0]
 [  8   0   1   0   0   0   0   0   3   0   0   0   0]
 [ 72   0   0   7   0   0   0   0  57   1   0   0   5]
 [ 31   0   0   0   0   2   0   0   2  23   0  14   0]
 [ 26   0   0  59   4   2   0   0   0   0  25   0   0]
 [  4   0   0   0   0   9   0   0   2   9   0  68   0]
 [  6   0   1   1   0   0   0   0   0   0   0   0  21]]
Epoch 4:
[[862  12   4  38   7   1   1   0  32  23   0   4   2]
 [ 40   9  10   4   3   0   0   0   4   0   0   0   0]
 [ 21   6   9   0   2   0   0   0   0   0   0   0   0]
 [ 71  12   0 453  16   6   8   0   1   0  13   0   1]
 [ 10   0   0   9  30   2   0   0   0   0   0   0   0]
 [  6   0   0  23   2 110  19   0   4   4   0  24   0]
 [  0   0   0   8   0   9 483   0   9   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 72   0   0   0   0   0   0   0  69   1   0   0   0]
 [ 36   0   0   0   0   2   0   0   2  19   0  13   0]
 [ 26   0   0  57   4   2   0   0   6   0  21   0   0]
 [  5   0   0   0   0  10   0   0   2  10   0  65   0]
 [ 15   1   0   0   0   0   0   0   0   0   1   0  12]]
=> Iteration 1:
Epoch 1:
[[651   0  17 190  15  18   3   0  32   0   3  44  13]
 [ 11   1  23  22   3   0   0   0  10   0   0   0   0]
 [ 10   0  23   1   2   2   0   0   0   0   0   0   0]
 [  6   0   2 514  14   7  17   0   1   0  15   0   5]
 [  7   0   0  10  32   2   0   0   0   0   0   0   0]
 [  3   0   0   7   4 132  27   0   4   0   0  15   0]
 [  0   0   0   6   0  11 492   0   0   0   0   0   0]
 [  5   0   1   0   0   0   0   0   6   0   0   0   0]
 [ 40   0   0   7   0   1   4   0  87   0   0   3   0]
 [ 14   0   0   0   0  10   0   0   2   0   0  46   0]
 [ 25   0   0  53   3   6   4   0   6   0  19   0   0]
 [  0   0   0   0   0  30   4   0   2   0   0  56   0]
 [  7   0   1   1   0   1   0   0   0   0   0   1  18]]
Epoch 2:
[[909   2   2  19   6   0   1   0  30   6   1   3   7]
 [ 49   3   2   4   3   0   0   0   9   0   0   0   0]
 [ 27   6   3   0   2   0   0   0   0   0   0   0   0]
 [ 87   0   0 432  14   6  17   0   0   0  25   0   0]
 [ 10   0   0   9  30   2   0   0   0   0   0   0   0]
 [ 12   0   0  12   1  94  43   0   4   3   0  23   0]
 [  0   0   0   6   0   2 496   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 60   0   0   0   0   0   0   0  82   0   0   0   0]
 [ 47   0   0   0   0   0   0   0   2   8   0  15   0]
 [ 38   0   0  40   2   4   4   0   5   0  23   0   0]
 [ 10   0   0   0   0   5   0   0   2   7   0  68   0]
 [ 18   0   0   0   0   0   0   0   0   0   0   0  11]]
Epoch 3:
[[814  10   4  81  11   2   1   0  23  16   0  12  12]
 [ 34  12   1  22   1   0   0   0   0   0   0   0   0]
 [ 15  15   3   3   0   2   0   0   0   0   0   0   0]
 [ 40   4   0 501   7   6  13   0   0   0   9   0   1]
 [  7   0   0  20  22   2   0   0   0   0   0   0   0]
 [  6   0   0  10   2 107  36   0   4   2   0  25   0]
 [  5   0   0   6   0   7 491   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 78   0   0   0   0   0   1   0  59   4   0   0   0]
 [ 37   0   0   0   0   2   0   0   0  15   0  18   0]
 [ 37   0   0  58   2   6   0   0   0   0  13   0   0]
 [  6   0   0   0   0  10   0   0   0   6   0  70   0]
 [ 11   0   0   1   0   0   0   0   0   0   0   0  17]]
Epoch 4:
[[866  16   4  38   7   1   1   0  33  11   0   2   7]
 [ 29  16   8   8   3   0   0   0   6   0   0   0   0]
 [ 18   9   9   0   2   0   0   0   0   0   0   0   0]
 [ 62  12   0 451  19   6   9   0   0   0  22   0   0]
 [  7   0   0   9  33   2   0   0   0   0   0   0   0]
 [  8   0   0   9   2 117  27   0   4   1   0  24   0]
 [  0   0   0   6   0   9 484   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 64   0   0   0   0   0   0   0  78   0   0   0   0]
 [ 42   0   0   0   0   2   0   0   2  12   0  14   0]
 [ 26   1   0  49   3   6   3   0   5   0  23   0   0]
 [  5   0   0   0   0  12   0   0   2   9   0  64   0]
 [ 16   0   0   0   0   0   0   0   0   0   1   0  12]]
=> Iteration 2:
Epoch 1:
[[846  15   9  13   8   2   1   0  37   1   1  45   8]
 [ 28  16   7   6   3   0   0   0  10   0   0   0   0]
 [ 16   7  11   0   2   2   0   0   0   0   0   0   0]
 [118  11   7 387  19   8   9   0   1   0  20   0   1]
 [  9   0   0   3  36   3   0   0   0   0   0   0   0]
 [ 12   0   0  11   2 115  20   0   4   0   0  28   0]
 [  0   0   0  10   0   6 488   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 56   0   0   0   0   0   0   0  82   0   0   4   0]
 [ 29   0   0   0   0   1   0   0   0   3   0  39   0]
 [ 36   1   0  44   3   6   0   0  11   0  15   0   0]
 [ 16   0   0   0   0   5   0   0   0   0   0  71   0]
 [ 16   0   0   0   0   0   0   0   0   0   0   1  12]]
Epoch 2:
[[814   7   4  65   6   0   1   0  32   6   0  43   8]
 [ 31   7   2  22   1   0   0   0   7   0   0   0   0]
 [ 17   5  11   3   0   0   0   0   0   0   0   2   0]
 [ 39   0   0 515   5   6  14   0   1   0   0   0   1]
 [  7   0   0  20  22   2   0   0   0   0   0   0   0]
 [  6   0   0  13   1 109  26   0   4   0   0  33   0]
 [  0   0   0   2   0  10 497   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 56   0   0   3   0   0   0   0  72   7   0   4   0]
 [ 30   0   0   0   0   0   0   0   0   6   0  36   0]
 [ 31   0   0  73   2   4   0   0   6   0   0   0   0]
 [  4   0   0   0   0   4   0   0   0   0   0  84   0]
 [ 11   0   0   1   0   0   0   0   0   0   0   1  16]]
Epoch 3:
[[786   8   6  86  13   2   3   0  34  16   3  16  13]
 [ 32   3   7  17   3   0   0   0   8   0   0   0   0]
 [ 17   2  13   4   0   2   0   0   0   0   0   0   0]
 [ 41   0   0 492  16   7  15   0   1   0   8   0   1]
 [  6   0   0  14  29   2   0   0   0   0   0   0   0]
 [  6   0   0   7   3 118  27   0   4   2   0  25   0]
 [  0   0   0   4   0   6 499   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 59   0   0   3   0   0   0   0  74   4   0   0   2]
 [ 37   0   0   0   0   2   0   0   2  11   0  20   0]
 [ 26   0   0  55   4   6   3   0  11   0  11   0   0]
 [  5   0   0   0   0  10   0   0   2   4   0  71   0]
 [  8   0   0   2   0   0   0   0   0   0   0   0  19]]
Epoch 4:
[[816  22   7  60   6   2   1   0  34  26   1   3   8]
 [ 28  11   9  10   3   0   0   0   9   0   0   0   0]
 [ 15   3  15   3   0   2   0   0   0   0   0   0   0]
 [ 64  12   0 462  14   6  10   0   1   0  11   0   1]
 [  7   0   0  15  27   2   0   0   0   0   0   0   0]
 [  7   0   0  12   1 120  23   0   4   1   0  24   0]
 [  0   0   0   5   0  13 491   0   0   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 69   0   0   0   0   0   0   0  66   7   0   0   0]
 [ 36   0   0   0   0   2   0   0   2  21   0  11   0]
 [ 26   0   0  54   4   6   0   0  11   0  15   0   0]
 [  4   0   0   0   0  12   0   0   2   8   0  66   0]
 [ 13   0   0   1   0   0   0   0   0   0   0   0  15]]
=> Iteration 3:
Epoch 1:
[[856   8   2  12   7   2   1   0  29   0   4  54  11]
 [ 20  27   2  10   1   0   0   0  10   0   0   0   0]
 [ 18   9   7   0   2   2   0   0   0   0   0   0   0]
 [ 67   2   0 449   7   6  13   0   1   0  31   0   5]
 [  6   0   0  16  26   2   0   0   0   0   0   0   1]
 [  6   0   0   9   2 109  37   0   5   0   0  24   0]
 [  0   0   0   5   0   2 493   0   9   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 58   0   0   0   0   0   0   0  77   3   0   4   0]
 [ 15   0   0   0   0   3   0   0   2   0   0  52   0]
 [ 26   1   0  34   2   6   4   0  11   0  32   0   0]
 [  3   0   0   0   0  16   0   0   2   0   0  71   0]
 [ 12   0   0   0   0   1   0   0   0   0   0   1  15]]
Epoch 2:
[[837  16   5  26  12   2   4   0  28  24   4  11  17]
 [ 15  24  10   8   3   0   0   0   7   0   3   0   0]
 [ 14  12   9   1   2   0   0   0   0   0   0   0   0]
 [ 45   8   0 465  15   6   9   0   1   0  27   0   5]
 [  6   0   0   9  33   2   0   0   0   0   0   0   1]
 [  5   0   0   9   3 122  33   0   4   2   3  11   0]
 [  0   0   0   6   0   4 494   0   5   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 65   0   0   0   0   0   4   0  64   9   0   0   0]
 [ 18   0   0   0   0   8   0   0   2  28   0  16   0]
 [ 26   1   0  37   3   4   0   0   6   0  39   0   0]
 [  4   0   0   0   0  34   0   0   2   5   0  47   0]
 [ 10   0   0   0   0   1   0   0   0   0   0   0  18]]
Epoch 3:
[[894   9   0  51   6   1   1   0  20   1   0   1   2]
 [ 45  12   2   8   3   0   0   0   0   0   0   0   0]
 [ 21  11   4   2   0   0   0   0   0   0   0   0   0]
 [ 48   2   0 502   7   6   9   0   0   0   2   0   5]
 [ 10   0   0  15  24   2   0   0   0   0   0   0   0]
 [  7   0   0  18   1 117  21   0   4   0   0  24   0]
 [  5   0   0  10   0  11 483   0   0   0   0   0   0]
 [  8   1   0   0   0   0   0   0   3   0   0   0   0]
 [ 91   0   0   3   0   0   1   0  47   0   0   0   0]
 [ 54   0   0   0   0   2   0   0   2   5   0   9   0]
 [ 26   1   0  69   2   2   0   0   0   0  16   0   0]
 [ 12   0   0   0   0  16   0   0   2   1   0  61   0]
 [ 18   0   0   1   0   0   0   0   0   0   0   0  10]]
Epoch 4:
[[856  21   5  43   7   2   1   0  27  13   2   7   2]
 [ 28  16   3   9   3   0   0   0   9   0   2   0   0]
 [ 16  11   7   2   0   2   0   0   0   0   0   0   0]
 [ 48  17   0 463  14   6   8   0   0   0  20   0   5]
 [  7   0   0  14  28   2   0   0   0   0   0   0   0]
 [  7   0   0  16   2 118  20   0   4   2   0  23   0]
 [  0   0   0   9   0   9 481   0  10   0   0   0   0]
 [  5   1   0   0   0   0   0   0   6   0   0   0   0]
 [ 82   0   0   0   0   0   1   0  59   0   0   0   0]
 [ 35   0   0   0   0   2   0   0   2  17   0  16   0]
 [ 26   1   0  47   4   6   3   0   5   0  24   0   0]
 [  4   0   0   0   0  16   0   0   2  10   0  60   0]
 [ 17   1   0   0   0   0   0   0   0   0   1   0  10]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.998870   0.863939   0.729412   0.729412    0.729412      0.698643      0.729412       0.690754
Iteration 1    1.001510   0.939954   0.700692   0.700692    0.700692      0.711061      0.700692       0.680443
Iteration 2    1.005725   0.820990   0.720415   0.720415    0.720415      0.724398      0.720415       0.704028
Iteration 3    1.018498   0.763575   0.748097   0.748097    0.748097      0.734704      0.748097       0.733702

Epoch: 2
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.786244   0.790360   0.744637   0.744637    0.744637      0.731970      0.744637       0.726218
Iteration 1    0.792232   0.792749   0.747059   0.747059    0.747059      0.722914      0.747059       0.719302
Iteration 2    0.792915   0.861573   0.744983   0.744983    0.744983      0.707563      0.744983       0.715119
Iteration 3    0.788254   0.750196   0.754325   0.754325    0.754325      0.743359      0.754325       0.746779

Epoch: 3
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.745280   0.794586   0.736332   0.736332    0.736332      0.717062      0.736332       0.718815
Iteration 1    0.752044   0.805727   0.734948   0.734948    0.734948      0.713928      0.734948       0.710943
Iteration 2    0.747221   0.816941   0.735640   0.735640    0.735640      0.711656      0.735640       0.713161
Iteration 3    0.748598   0.785856   0.752595   0.752595    0.752595      0.745612      0.752595       0.720804

Epoch: 4
             Train loss  Test loss  P (micro)  R (micro)  F1 (micro)  P (weighted)  R (weighted)  F1 (weighted)
Iteration 0    0.684121   0.814659   0.741176   0.741176    0.741176      0.727134      0.741176       0.725151
Iteration 1    0.700246   0.796781   0.749135   0.749135    0.749135      0.731692      0.749135       0.733728
Iteration 2    0.681569   0.808423   0.735294   0.735294    0.735294      0.719334      0.735294       0.720441
Iteration 3    0.691507   0.770059   0.740138   0.740138    0.740138      0.722893      0.740138       0.725642

